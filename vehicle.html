<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Vehicle</title>
        <script src="jquery-3.6.0.js"></script>
        <script src="./javascript/imageArray.js"></script>
        <link rel="stylesheet" href="style.css">

        <style>
            .container {
                position: relative;
            }

            img { 
                width: 100%;
                vertical-align: middle;
            }

            .prev, 
            .next { 
                background-color: rgb(12, 104, 181, 0.3);
                cursor: pointer;
                position: absolute;
                top: 40%;
                width: auto;
                padding: 16px;
                margin-top: -50px;
                color: white;
                font-weight: bold;
                font-size: 20px;
                border-radius: 0 3px 3px 0;
                user-select: none;
                -webkit-user-select: none;
            }

            .next {
                right: 0;
                border-radius: 3px 0 0 3px;
            }

            .prev:hover,
            .next:hover {
                background-color:  rgb(12, 104, 181, 1.0)
            }
            
            .column {
                float: left;
                width: 16.66%;
            }
        </style>

    </head>
    <body class="wrapper container" onload="makeImage();">
        <header class="bg-primary">
            <div class="flex flex-column">
                <div class="secondary">
                    <div class="left">
                        <a href="index.html">
                            <img style="height: 50px" src="images/logos/logo-1.jpg" ></img>
                        </a>
                    </div>
                    <div class="right">Contact</div>
                    <div class="right">Social Media</div>
                </div>
                <div class="bg-secondary">
                    <ul class="flex justify-around list-style-none h3 caps">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="inventory.html">Inventory</a></li>
                        <li><a href="contact.html">Contact</a></li>
                        <li><a href="about.html">About</a></li>
                    </ul>
                </div>
        
            </div>
        </header>

        <div>
            <br>
            <h1>2009 Mazda RX-8</h1>
            <h3>$15,000</h3>
            <br>
        </div>
        <!-- <div class="contents" id="content"></div>
        <button onclick="nextImage()">Next Image</button> -->

        <div id="splash">
            <img src="./images/mazda-rx8-2009-06548/image-1.jpg" alt="image-1" id="mainImage">
        </div> 
        <div id="controls">
            <a class="prev" onclick="previousImage()">❮</a>
            <a class="next" onclick="nextImage()">❯</a>
        </div>

        <div id="vehicle-gallery" class="flex flex-wrap left">
            <!-- Vehicle Gallery Grid -->
        </div>

        <br>
        <br>


            
        <!-- ============================================ -->
        <!--                    FOOTER                    -->
        <!-- ============================================ -->
        <footer class="white bg-black">
            <div class='flex flex-wrap justify-evenly footer'>
                <div class="left-align">
                <h3 class="primary">CONTACT US</h3>
                <p>
                    <span class="gray">PHONE:</span>
                    <br />
                    (555) 555-5555
                </p>
                <p>
                    <span class="gray">EMAIL:</span>
                    <br />
                    <a href='https://www.google.com' class='white'>info@dealersite.com</a>
                </p>
                <p>
                    <span class="gray">ADDRESS:</span>
                    <br />
                    123 Maple St.
                    <br />
                    Somewhere, SS 38382
                </p>
                </div>
                <div class="left-align">
                <h3 class="primary">OPENING HOURS</h3>
                <p class="gray">(By appointment)</p>
                <p>
                    <span class="gray">MON: </span>
                    9:00am - 5:30pm
                    <br />
                    <span class="gray">TUE: </span>
                    9:00am - 5:30pm
                    <br />
                    <span class="gray">WED: </span>
                    9:00am - 5:30pm
                    <br />
                    <span class="gray">THU: </span>
                    9:00am - 5:30pm
                    <br />
                    <span class="gray">FRI: </span>
                    9:00am - 5:30pm
                    <br />
                    <span class="gray">SAT: </span>
                    9:00am - 5:30pm
                    <br />
                    <span class="gray">SUN: </span>
                    CLOSED
                    <br />
                </p>
                </div>
                <div class="left-align">
                <h3 class="primary">LINKS</h3>
                <ul class="list-style-none">
                    <li>
                    <Link class="white" to="/home">HOME</Link>
                    </li>
                    <li>
                    <Link class="white" to="/inventory">INVENTORY</Link>
                    </li>
                    <li>
                    <Link class="white" to="/about">CONTACT</Link>
                    </li>
                    <li>
                    <Link class="white" to="/contact">ABOUT</Link>
                    </li>
                </ul>
                </div>
                <div>
                <h3 class="primary">SOCIAL MEDIA</h3>
                <ul class="list-style-none">
                    <li>
                    <a  class="white" href="https://www.youtube.com">Youtube</a>
                    </li>
                    <li>
                    <a  class="white" href="https://www.facebook.com">Facebook</a>
                    </li>
                    <li>
                    <a  class="white" href="https://www.instagram.com">Instagram</a>
                    </li>
                </ul>
                </div>
            </div>
        </footer>

        <script>
            // $.getJSON("vehicle-gallery.json", function(data) {
            //     let vehicleGallery = document.querySelector("#vehicle-gallery");

            //     data.forEach(function(val) {
            //         vehicleGallery.innerHTML +=
            //                                 `<div class="column" style="padding: 2px">
            //                                     <img src="${val.image_url}" alt="vehicle" style="  object-fit: cover">
            //                                 </div>`;
            //     });
            // });

            // function doPortItem(n) {
            //     let vehicleGallery = document.querySelector("#vehicle-gallery");
            //     let img = document.createElement('img');

            //     img.src = './images/mazda-rx8-2009-06548/image-' + n + '.jpg';  // !!!Need to check for other file extensions

            //     img.addEventListener('load', () => {
            //         let div =  `<div class="column" style="padding: 2px">
            //                         <img src="${img.src}" alt="vehicle" style="object-fit: cover">
            //                     </div>`;
            //         vehicleGallery.innerHTML += div;
            //         doPortItem(++n)
            //     })
            // }
            
            // doPortItem(1)

            var carFolder = sessionStorage.getItem("carFolder");
            console.log("VHEKCLE", carFolder);

            const folder = "images/mazda-rx8-2009-06548/image-";
            const maxImages = 41; // Arbitrary large number; should get item count, otherwise it prints alt image txt up to set #
            const suffix = ["jpg", "jpeg", "png"];
            
            let cnt = 0, idx = 1, vehicleGallery, img;  // if idx = 0, it won't show images


            const loadImage = () => {
                if (idx >= maxImages) return;
                if (cnt === 0) img = new Image();

                img.src = folder + idx + "." + suffix[cnt];  // !!!Need to check for other file extensions

                img.onload = function () {
                    let div =  `<div class="column" style="padding: 2px">
                                    <img src="${img.src}" alt="vehicle" style="object-fit: cover">
                                </div>`;
                    vehicleGallery.innerHTML += div;
                    // vehicleGallery.appendChild(saveImg); This doesn't have CSS applied like the div above
                    idx++;
                    cnt = 0;
                    loadImage()
                }

                img.onerror = function () {
                    cnt++; // try next suffix
                    if (cnt >= suffix.length) {
                        console.log("gave up")

                        let div =  `<div class="column" style="padding: 2px">
                                        <img src="${img.src}" alt="image-${idx} not available" style="object-fit: cover">
                                    </div>`;
                        vehicleGallery.innerHTML += div;
                        cnt = 0; 
                        idx++;
                    }
                    loadImage();
                }

                console.log("6  trying to load", folder + idx + "." + suffix[cnt]);


            }
            
 
            window.addEventListener("load", function () {
                console.log("1  addEventListener");

                vehicleGallery = document.getElementById("vehicle-gallery");
                
                loadImage();
                
                img.addEventListener('load', () => {
                    console.log("2  img.addEventListener");

                    // console.log(" img.addEventListene img.addEventListene");

                    // let div =  `<div class="column" style="padding: 2px">
                    //                 <img src="${img.src}" alt="vehicle" style="object-fit: cover">
                    //             </div>`;
                    // vehicleGallery.innerHTML += div;
                    // idx++;
                    // cnt = 0;
                    // loadImage(idx)
                })
            });

            
        </script>
    </body>
</html>

<!-- 
    [REF]: 

    JavaScript Array of Images
    https://www.delftstack.com/howto/javascript/javascript-array-of-images/ 

    How TO - Slideshow Gallery
    https://www.w3schools.com/howto/howto_js_slideshow_gallery.asp

    Load images from folder into HTML page for display in gallery/album automatically as they are added to folder
    https://stackoverflow.com/questions/68107197/load-images-from-folder-into-html-page-for-display-in-gallery-album-automaticall

-->